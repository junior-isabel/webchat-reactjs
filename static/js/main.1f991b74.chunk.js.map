{"version":3,"sources":["api/api.js","utils/token.js","api/services/accounts.js","api/services/profile.js","components/cardLogin/card-login.js","api/services/cities.js","components/cardSignup/card-signup.js","pages/public/register/register.js","routes/public/publicRoutes.js","components/messageUser/message-user.js","components/menu/menu.js","components/layouts/default.js","components/widgets/headers/app-header.js","components/cardMessage/card-message.js","components/listMessage/list-message.js","api/services/messages.js","components/input-message/input-message.js","api/services/friend.js","stores/reducers/chat.js","stores/reducers/talk.js","stores/reducers/messages.js","stores/reducers/notifications.js","stores/reducers/call.js","stores/constants.js","stores/reducers/stream.js","stores/reducers/peer.js","pages/private/home/home.js","api/services/findFriend.js","api/socket.js","pages/private/FindFriend/findFriend.js","pages/private/validateAccount/validate-account.js","pages/private/logout/logout.js","pages/private/AcceptRequest/accept-request.js","routes/private/privateRoutes.js","routes/routes.js","components/callModal/call.js","components/ReceiveCallVideo/receive-call-video.js","App.js","stores/reducers/reducers.js","stores/store.js","stores/reducers/me.js","index.js","assets/logo.png"],"names":["api","axios","create","baseURL","process","headers","mode","getToken","key","JSON","parse","localStorage","getItem","token","setToken","setItem","stringify","getUserToken","username","password","a","post","result","data","removeItem","response","get","status","useState","email","setEmail","setPassword","history","useHistory","socket","useSelector","state","className","join","method","onSubmit","event","preventDefault","login","then","getProfile","user","emit","setTimeout","push","alert","message","catch","err","src","logo","width","alt","htmlFor","type","name","value","onChange","e","target","placeholder","required","id","Error","error","submit","statusForm","firstName","setFirstName","lastName","setLastName","sexo","setSexo","birthday","setBirthday","phone","setPhone","repassword","setRepassword","cityId","setCity","cities","setCities","useEffect","getCities","_cities","$cities","action","map","city","props","document","title","setStatus","path","component","RegisterPage","handlerOpenMessage","profile","alerts","talk","chat","talks","find","userFrom","userTo","getTalk","onClick","Avatar","Person","fontSize","counter","time","isShowMenu","setIsShowMenu","links","Menu","color","Object","keys","index","to","children","handlerCallUser","VideoCall","NotificationsOff","MoreVert","User","data-username","href","urlImage","rel","data-image","height","style","maxWidth","maxHeight","onError","lazys","Array","from","querySelectorAll","length","dataset","image","querySelector","onscroll","evt","lazy","getBoundingClientRect","top","forEach","item","imageTop","imageHeight","classList","contains","remove","text","updatedAt","split","messages","inbox","timeId","element","scrollHeight","scrollTo","scrollTop","clearTimeout","formData","FormData","append","userId","meId","setMessage","setImage","previewImage","setPreviewImage","send","sendMessageId","res","AttachFile","accept","files","URL","createObjectURL","onKeyDown","keyCode","Send","CloseRounded","stateInitial","friends","initialState","chatTalks","peer","useRef","dispatch","useDispatch","getFriends","payload","undefined","listMessagesId","TypeActions","talkId","callUser","navigator","mediaDevices","getUserMedia","video","stream","current","Peer","initiator","trickle","console","log","getFriendIdTalk","disabled","Search","selectMessage","filter","friend","getPeople","getSolicities","put","users","setUsers","handlerSolicitarAmizade","addFriend","_users","loadData","AccountCircle","maxLength","autoComplete","validate-account-form","Done","clear","pathname","acceptFriend","PrivateRoute","rest","autheticate","render","location","exact","LogoutPage","CallModal","statusCall","call","localVideo","remoteVideo","getUser","srcObject","on","getTracks","track","removeTrack","signal","offer","socketTo","answer","ref","autoPlay","destroy","acceptCall","PhoneCallback","App","Modal","socketIo","window","off","reducers","combineReducers","store","assign","concat","me","createStore","ReactDOM","StrictMode","getElementById","module","exports"],"mappings":"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","file":"static/js/main.1f991b74.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nconst api = axios.create({\r\n    baseURL: process.env.REACT_APP_URL, // https://mubenq-chat.herokuapp.com/\r\n    headers: {\r\n        'content-type': 'application/json',\r\n        'Access-Control-Allow-Origin': '*',\r\n        mode: 'cors'\r\n    }\r\n})\r\nexport default api","export default function getToken () {\r\n    const key = (JSON.parse(localStorage.getItem('token')))\r\n    return key ? key.token : ''\r\n}\r\n\r\nexport function setToken(token) {\r\n\r\n    localStorage.setItem('token', JSON.stringify(token))\r\n}\r\n\r\nexport function setUserToken (user) {\r\n    localStorage.setItem('token-user', JSON.stringify(user))\r\n}\r\n\r\nexport function getUserToken () {\r\n    return JSON.parse(localStorage.getItem('token-user'))\r\n}","import api from '../api'\r\nimport { setToken } from '../../utils/token'\r\nexport async function login(username, password) {\r\n  let result\r\n  try {\r\n    result = await api.post('/auths', { username, password })\r\n    setToken(result.data)\r\n    return result.data\r\n  } catch (err) {\r\n    localStorage.removeItem('token')\r\n    return err.response\r\n  }\r\n}\r\nexport async function create(data) {\r\n  let result\r\n  try {\r\n    result = await api.post('/accounts', data)\r\n    return result\r\n  } catch (err) {\r\n    return err.response\r\n  }\r\n}","import api from '../api'\r\nimport getToken from '../../utils/token'\r\n\r\nexport default async function getProfile() {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.get('/profile-user', {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}","import React, { useState } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport './card-login.scss'\r\nimport logo from '../../assets/logo.png'\r\nimport { login } from '../../api/services/accounts'\r\nimport getProfile from '../../api/services/profile'\r\nimport { setUserToken } from '../../utils/token'\r\nimport { useSelector } from 'react-redux'\r\nexport default ({status}) => {\r\n  const [email, setEmail] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const history = useHistory()\r\n  const socket = useSelector(state => state.socket)\r\n  const handlerForm = (event) => {\r\n    event.preventDefault()\r\n\r\n    login(email, password).then(login => {\r\n      if(!login.token) {\r\n\r\n        alert(login.data.message)\r\n        return\r\n      }\r\n      getProfile().then((data) => {\r\n        if (!data) return\r\n          if (socket) {\r\n            setUserToken(data)\r\n            socket.emit('set token', login.token)\r\n            setTimeout(() => history.push('/'), 200)\r\n          }\r\n\r\n      })\r\n    }).catch(err => {\r\n    })\r\n\r\n  }\r\n  return (\r\n    <div className={['card-form-login',status ? 'active-login' : ''].join(' ')}>\r\n      <form method=\"POST\" onSubmit={handlerForm}>\r\n        <figure>\r\n          <img src={logo} width=\"80\" alt=\"logo\" />\r\n        </figure>\r\n        <label htmlFor=\"\">\r\n          <input type=\"text\" name=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"email\" required />\r\n        </label>\r\n        <label htmlFor=\"\">\r\n          <input type=\"password\" name=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} placeholder=\"password\" id=\"\" required />\r\n        </label>\r\n        <button type=\"submit\">login</button>\r\n      </form>\r\n    </div>\r\n  )\r\n}","import api from '../api'\r\n\r\n\r\nexport async function getCities() {\r\n  let result\r\n  try {\r\n    result = api.get('/cities').then(data => data).catch(err => {\r\n      throw new Error(err)\r\n    })\r\n    \r\n    return (await result).data\r\n  } catch (error) {\r\n    return {\r\n      error,\r\n      data: []\r\n    }\r\n  }\r\n}","import React, { useEffect, useState } from 'react'\r\n\r\nimport './card-signup.scss'\r\nimport { getCities } from '../../api/services/cities'\r\n\r\nexport default ({submit, statusForm}) => {\r\n  const [firstName, setFirstName] = useState('')\r\n  const [lastName, setLastName] = useState('')\r\n  const [sexo, setSexo] = useState('')\r\n  const [birthday, setBirthday] = useState('')\r\n  const [email, setEmail] = useState('')\r\n  const [phone, setPhone] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [repassword, setRepassword] = useState('')\r\n  const [cityId, setCity] = useState(-1)\r\n  const [cities, setCities] = useState([])\r\n  const handlerSubmit = (e) => {\r\n    e.preventDefault()\r\n    if (cityId === -1) return\r\n    if (firstName === '') return\r\n    submit({\r\n      firstName,\r\n      lastName,\r\n      sexo,\r\n      birthday,\r\n      cityId,\r\n      email,\r\n      phone,\r\n      password,\r\n      repassword\r\n    })\r\n  }\r\n  useEffect(() => {\r\n    if (statusForm === 200) {\r\n      setFirstName('')\r\n      setLastName('')\r\n      setSexo('')\r\n      setBirthday('')\r\n      setEmail('')\r\n      setPhone('')\r\n      setPassword('')\r\n      setRepassword('')\r\n      setCity(-1)\r\n      setCities([])\r\n    }\r\n  }, [statusForm])\r\n\r\n  useEffect(() => {\r\n    getCities().then(_cities => {\r\n      let $cities = _cities.error ? [] : _cities\r\n      setCities($cities)\r\n    })\r\n  }, [])\r\n  return (\r\n    <form action=\"\" method=\"POST\" className=\"card-signup-form\" onSubmit={handlerSubmit}>\r\n      <ul>\r\n        <li>\r\n          <label htmlFor=\"firstName\">\r\n            <input type=\"text\"\r\n              name=\"firstName\"\r\n              value={firstName}\r\n              onChange={(e) => setFirstName(e.target.value)} placeholder=\"Primeiro Nome\" /></label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"lastName\">\r\n            <input type=\"text\" name=\"lastName\"\r\n              value={lastName}\r\n              onChange={(e) => setLastName(e.target.value)}\r\n              required={true}\r\n              placeholder=\"último Nome\" /></label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"register-sexo\">Sexo\r\n            <select name=\"sexo\" id=\"register-sexo\"\r\n              value={sexo}\r\n              onChange={e => setSexo(e.target.value)}\r\n            >\r\n              <option value=\"\">nenhum</option>\r\n              <option value=\"m\">Masculino</option>\r\n              <option value=\"f\">Femenino</option>\r\n            </select>\r\n          </label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"birthday\">\r\n            <input type=\"date\" name=\"birthday\"\r\n              value={birthday}\r\n              onChange={e => setBirthday(e.target.value)}\r\n              id=\"register-birthday\" />\r\n          </label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"register-sexo\">Cidade natal\r\n            <select name=\"cityId\" id=\"cities\"\r\n              value={cityId}\r\n              onChange={e => setCity(e.target.value)}\r\n            >\r\n              <option value=\"\">seleciona</option>\r\n              {cities.map(city => {\r\n\r\n                return (<option key={city.id} value={city.id} >{city.name}</option>)\r\n\r\n              })}\r\n            </select>\r\n          </label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"phone\"><input type=\"phone\"\r\n            value={phone}\r\n            onChange={e => setPhone(e.target.value)}\r\n            name=\"phone\"\r\n            placeholder=\"Número de Telefone\" /></label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"email\"><input type=\"email\"\r\n          required={true}\r\n            value={email}\r\n            onChange={e => setEmail(e.target.value)}\r\n            name=\"email\" placeholder=\"Seu Emal\" /></label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"register-password\">\r\n            <input type=\"password\" name=\"passwrod\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              id=\"register-password\" placeholder=\"palavra passe\" />\r\n          </label>\r\n        </li>\r\n        <li>\r\n          <label htmlFor=\"register-repassword\">\r\n            <input type=\"password\" name=\"repasswrod\"\r\n              value={repassword}\r\n              onChange={e => setRepassword(e.target.value)}\r\n              id=\"register-repassword\" placeholder=\"re-introduzir palavra passe\" />\r\n          </label>\r\n        </li>\r\n        <li>\r\n          <button type=\"submit\">cadastrar-se</button>\r\n        </li>\r\n      </ul>\r\n    </form>\r\n  )\r\n}","import React, { useState } from 'react'\r\nimport './register.scss'\r\nimport CardLogin from '../../../components/cardLogin/card-login'\r\nimport CardSignup from '../../../components/cardSignup/card-signup'\r\nimport { create } from '../../../api/services/accounts'\r\n\r\n\r\n\r\nexport default (props) => {\r\n  document.title = \"login - mubenq\"\r\n  const [status, setStatus] = useState(0)\r\n\r\n  const handlerSubmit = (data) => {\r\n    \r\n    create(data).then(response => {\r\n      alert('sua conta foi criada,  inicia a sua sessão em login')\r\n      setStatus(response.status)\r\n      \r\n    })\r\n  }\r\n  return (\r\n    <section className=\"login-page\">\r\n      <header>\r\n        <div className=\"description\">\r\n          <h1>cadastra-se em MyChat</h1>\r\n          <p>meu texto, é algo como fazer login no meu chat empresarial</p>\r\n          <CardSignup submit={handlerSubmit} statusForm={status}/>\r\n        </div>\r\n      </header>\r\n      <div className=\"form-absolute\">\r\n        <CardLogin status={status} />\r\n      </div>\r\n    </section>\r\n  )\r\n}","import React from 'react'\r\nimport {Switch ,Route} from 'react-router-dom'\r\nimport RegisterPage from '../../pages/public/register/register'\r\nexport default () => {\r\n\r\n    return (\r\n        <Switch>\r\n        <Route path=\"/register\" component={RegisterPage} />\r\n        </Switch>\r\n    )\r\n}","import React from 'react'\r\nimport { Person } from '@material-ui/icons'\r\nimport { Avatar } from '@material-ui/core'\r\nimport { getUserToken } from '../../utils/token'\r\nimport { useSelector } from 'react-redux'\r\nimport './message-user.scss'\r\n\r\n\r\nexport default ({ user, handlerOpenMessage }) => {\r\n  const profile = getUserToken()\r\n  const alerts = useSelector(state => state.alerts)\r\n  let talks = useSelector(state => state.chat.talks)\r\n  const talk = talks.find(talk => talk[getTalk(talk, profile)] === user.id)\r\n  function getTalk (talk, profile) {\r\n    if (talk.userFrom === profile.id) return 'userTo'\r\n    else if (talk.userTo === profile.id) return 'userFrom'\r\n  }\r\n  return (\r\n    <section className=\"message-user\" onClick={handlerOpenMessage}>\r\n      <figure className=\"avatar\">\r\n        <Avatar>\r\n          <Person fontSize=\"large\" />\r\n        </Avatar>\r\n      </figure>\r\n      <div className=\"message-user-content\">\r\n        <header>\r\n          <label className=\"name\">{user.firstName} {alerts[talk.id] && alerts[talk.id].counter > 0 ? `(${alerts[talk.id].counter})` : ''}</label>\r\n          <label>{user.time}</label>\r\n        </header>\r\n        <div className=\"text\">\r\n        </div>\r\n      </div>\r\n    </section>\r\n  )\r\n}","import React, { useState } from 'react'\r\nimport {\r\n  Menu\r\n} from '@material-ui/icons'\r\nimport { Link } from 'react-router-dom'\r\nimport './menu.scss'\r\nexport default () => {\r\n  const [isShowMenu, setIsShowMenu] = useState(false)\r\n  const handlerShowMenu = () => {\r\n    setIsShowMenu(!isShowMenu)\r\n  }\r\n  const links = {\r\n    '/': 'Mensages',\r\n    '/findfriend': 'Encontrar amigos',\r\n    '/accept-request': 'Aceita Contactos',\r\n    '/logout': 'Sair'\r\n  }\r\n  return (\r\n    <nav className=\"app-navbar\">\r\n      <span className=\"icone-menu\" onClick={handlerShowMenu}>\r\n        <Menu fontSize=\"large\" color=\"primary\"></Menu>\r\n      </span>\r\n      <section className={`navbar-links ${isShowMenu ? 'active' : ''}`}>\r\n        <ul className=\"list-links\">\r\n          {\r\n            Object.keys(links)\r\n              .map((key, index) =>\r\n                (<li key={index}><Link to={key}>{links[key]}</Link></li>)\r\n              )}\r\n        </ul>\r\n      </section>\r\n    </nav>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport './default.scss'\r\nimport AppMenu from '../menu/menu'\r\nexport default ({ children }) => {\r\n  return (<div className=\"layout\">\r\n    <AppMenu />\r\n    <div className=\"layout-container\">\r\n      {children}\r\n    </div>\r\n  </div>)\r\n}","import React from 'react'\r\nimport { VideoCall , NotificationsOff, MoreVert } from '@material-ui/icons'\r\nimport './app-header.scss'\r\nexport default ({user, handlerCallUser}) => {\r\n    return (\r\n      <header className={`app-header content-header nav-height ${user ? '': 'hide'}`}>\r\n        <span className=\"user-active\">{user.firstName} {user.lastName}</span>\r\n        <div className=\"content-header-setting\">\r\n          <button className=\"btn-link\" onClick={() => handlerCallUser(user)}>\r\n            <VideoCall />\r\n          </button>\r\n          <button className=\"btn-link\">\r\n            <NotificationsOff />\r\n          </button>\r\n          <button className=\"btn-link\">\r\n            <MoreVert />\r\n          </button>\r\n      </div>\r\n      </header>\r\n)\r\n}","import React from 'react'\r\nimport { Avatar } from '@material-ui/core'\r\nimport './card-message.scss'\r\n\r\nexport default ({ message, profile }) => {\r\n\r\n  function loadingImage(e) {\r\n    // e.target.classList.add('lazyload')\r\n    const lazys = Array.from(document.querySelectorAll('.message-context .message-context-text .lazyload'))\r\n    if (lazys.length) {\r\n      lazys[lazys.length - 1].src = lazys[lazys.length - 1].dataset.image\r\n\r\n    }\r\n    document.querySelector('.card-list-message-scroll-down').onscroll = (evt) => {\r\n      const lazy = document.querySelectorAll('.message-context .message-context-text .lazyload')\r\n      const { top, height } = evt.target.getBoundingClientRect()\r\n      Array.from(lazy).forEach(item => {\r\n\r\n        const { top: imageTop, height: imageHeight } = item.getBoundingClientRect()\r\n\r\n        if (top < imageTop &&\r\n          top + height > imageTop + imageHeight &&\r\n          item.classList.contains('lazyload')) {\r\n\r\n          item.src = item.dataset.image\r\n          setTimeout(() => {\r\n            item.classList.remove('lazyload')\r\n          }, 800)\r\n        }\r\n      })\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <section className={['message-context', message.User.id === profile.id ? 'my-message' : ''].join(' ')}>\r\n      <div className=\"avatar\" data-username={`${message.User.firstName} ${message.User.lastName}`}>\r\n        <Avatar fontSize=\"large\" className={['avatar-title', message.User.id === profile.id ? 'user' : ''].join(' ')}>\r\n          {message.User.firstName[0]}{message.User.lastName[0]}\r\n        </Avatar>\r\n      </div>\r\n      <div className=\"message-context-text\">\r\n        {message.type === 'hipertext' &&\r\n          <a href={message.urlImage} target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <img src='#'\r\n              data-image={message.urlImage} width=\"100%\" height=\"100%\"\r\n              className=\"lazyload\"\r\n              style={{ maxWidth: '400px', maxHeight: '500px' }}\r\n              alt={message.urlImage}\r\n              onError={loadingImage}\r\n            />\r\n          </a>}\r\n        <div className=\"message-context-text.msg\">\r\n          <p className=\"text\">\r\n            {message.text}\r\n\r\n          </p>\r\n        </div>\r\n        <p className=\"details\"><b>{message.updatedAt.split('T')[0]}</b><b>{message.updatedAt.split('T')[1].split('.')[0]}</b></p>\r\n      </div>\r\n      <div className=\"metadata\">{message.time}</div>\r\n    </section>\r\n  )\r\n}","import React, { useEffect } from 'react'\r\nimport './list-message.scss'\r\nimport CardMessage from '../cardMessage/card-message'\r\nimport { getUserToken } from '../../utils/token'\r\nexport default ({ inbox }) => {\r\n\r\n  const messages = inbox.messages || []\r\n  const profile = getUserToken()\r\n  useEffect(() => {\r\n    let timeId = setTimeout(() => {\r\n      const element = document.querySelector('.card-list-message-scroll-down')\r\n      const height = element.scrollHeight\r\n      element.scrollTo(0, height + element.scrollTop)\r\n\r\n    }, 200)\r\n    return () => clearTimeout(timeId)\r\n  }, [messages])\r\n  return (\r\n    <section className=\"card-list-message card-list-message-scroll-down\">\r\n      <ul className=\"list-message\">\r\n        {messages.map((message, index) =>\r\n          <li key={index}>\r\n            <CardMessage message={message} profile={profile} />\r\n          </li>)}\r\n      </ul>\r\n    </section>)\r\n}","import api from '../api'\r\nimport getToken from '../../utils/token'\r\n\r\nexport default async function listMessagesId(id) {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.get('/messages/' + id, {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}\r\n\r\nexport async function sendMessageId(id, text, image, type) {\r\n    let result\r\n    try {\r\n      const token = getToken()\r\n      const formData = new FormData()\r\n      formData.append('text', text)\r\n      formData.append('type', type)\r\n      formData.append('image', image)\r\n     \r\n      result = await api.post('/messages/send/' + id, formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n          'Authorization': `Bearer ${token}`\r\n\r\n        }\r\n      })\r\n      return result.data\r\n    } catch (error) {\r\n      return error\r\n    }\r\n  }","import React, { useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport {\r\n  AttachFile,\r\n  Send,\r\n  CloseRounded\r\n} from '@material-ui/icons'\r\nimport './input-message.scss'\r\nimport { sendMessageId } from '../../api/services/messages'\r\nexport default ({ userId, meId }) => {\r\n\r\n  const [message, setMessage] = useState('')\r\n  const [image, setImage] = useState('')\r\n  const [previewImage, setPreviewImage] = useState('')\r\n  const socket = useSelector(state => state.socket)\r\n\r\n\r\n  function send() {\r\n    if (!message && !image) return\r\n    if (message.length > 5000) return\r\n    sendMessageId(userId, message, image, !!image ? 'hipertext' : '').then(res => {\r\n      setMessage('')\r\n\r\n      socket.emit('new-message', {userId, meId, message, image: res.urlImage, type: !!image ? 'hipertext': ''})\r\n      setPreviewImage('')\r\n      setImage('')\r\n      setTimeout(() => {\r\n        const element = document.querySelector('.card-list-message-scroll-down')\r\n        const height = (element && element.scrollHeight) || 0\r\n        element && element.scrollTo(0, height + element.scrollTop)\r\n      }, 100)\r\n    })\r\n  }\r\n  function addImage (e) {\r\n    e.preventDefault()\r\n\r\n    setImage(e.target.files[0])\r\n    setPreviewImage(URL.createObjectURL(e.target.files[0]))\r\n  }\r\n  function deletePreviewImage () {\r\n    setImage('')\r\n    setPreviewImage('')\r\n  }\r\n  return (\r\n    <div className=\"input-message\">\r\n      <label htmlFor=\"file-image\" className=\"file-message\" title=\"adicionar imagem\">\r\n      <AttachFile />\r\n      <input type=\"file\" id=\"file-image\" accept=\"image/*\" onChange={addImage} />\r\n      </label>\r\n      <label className=\"input-text\">\r\n        <input type=\"text\" onKeyDown={(e) => { e.keyCode === 13 && send() }} value={message} onChange={e => setMessage(e.target.value)} placeholder=\"text message...\" />\r\n       {/* <InsertEmoticon /> */}\r\n      </label>\r\n      <span onClick={send} title=\"enviar\">\r\n        <Send />\r\n      </span>\r\n      {previewImage && (\r\n        <div className=\"previewImage\">\r\n          <CloseRounded onClick={deletePreviewImage} className=\"close-button\"/>\r\n        <img src={previewImage} alt=\"preview-file\" width=\"100%\" height=\"100%\"/>\r\n      </div>\r\n      )}\r\n      \r\n    </div>\r\n  )\r\n}","import api from '../api'\r\nimport getToken from '../../utils/token'\r\n\r\nexport async function getFriends() {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.get('/users/friends', {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}","export const LIST_CHAT = \"LIST CHAT\"\r\nexport const SET_FRIEND_CHAT = \"SET FRIEND CHAT\"\r\nexport const RESET_CHAT = \"RESET CHAT\"\r\nconst stateInitial = {\r\n  friends: []\r\n}\r\n\r\nexport default function chat(store = stateInitial, action) {\r\n\r\n  switch (action.type) {\r\n\r\n    case SET_FRIEND_CHAT:\r\n      return Object.assign({}, store, { ...action.payload\r\n      })\r\n    case RESET_CHAT:\r\n      return stateInitial\r\n\r\n    default:\r\n      return store\r\n  }\r\n}","export const SET_MESSAGE_ACTIVE_USER = \"SET MESSAGE ACTIVE USER\"\r\nexport const RESET_MESSAGE_ACTIVE_USER = \"RESET MESSAGE ACTIVE USER\"\r\nconst initialState = {}\r\nexport default function talk (state = initialState, {type, payload}) {\r\n\r\n  switch (type) {\r\n    case SET_MESSAGE_ACTIVE_USER:\r\n      return { ...state, ...payload }\r\n      case RESET_MESSAGE_ACTIVE_USER:\r\n        return initialState\r\n    default:\r\n      return state\r\n  }\r\n}","export const SET_MESSAGE = 'SET MESSAGE'\r\nexport const ADD_MESSAGE = \"ADD MESSAGE\"\r\nexport const ADD_MESSAGE_ALERT = \"ADD MESSAGE ALERT\"\r\nexport const RESET_MESSAGE_ALERT =\"RESET MESSAGE ALERT\"\r\nconst initialState = { }\r\n\r\nexport default function messages (state = initialState, action) {\r\n  \r\n  const payload = action.payload\r\n  switch (action.type) {\r\n    case SET_MESSAGE:\r\n    return Object.assign({}, state, {\r\n      [payload.talkId]: {\r\n        messages: payload.messages\r\n      }\r\n    })\r\n    case ADD_MESSAGE:\r\n      if (state[payload.userId]) {\r\n        return Object.assign({}, state, {\r\n          [payload.userId]: Object.assign({}, state[payload.userId], {\r\n            messages: state[payload.userId].messages.concat(payload.message)\r\n          })\r\n        })\r\n      }\r\n      return state\r\n    case RESET_MESSAGE_ALERT:\r\n      return initialState\r\n\r\n    default:\r\n    return state\r\n  }\r\n}\r\n\r\n\r\n\r\n","export const ADD_NOTIFICATION_MESSAGE = \"COUNTER MESSAGE\"\r\nexport const INCREMENT_NOTIFICATION_MESSAGE = \"INCREMENT COUNTER MESSAGE\"\r\nexport const RESET_COUNTER_MESSAGE = \"RESET COUNTER MESSAGE\"\r\nexport const RESET_NOTIFICATION_MESSAGEM = \"RESET NOTIFICATION MESSAGE\"\r\nconst initialState = {}\r\n\r\nexport default function alerts(state = initialState, action) {\r\n\r\n  const payload = action.payload\r\n  switch (action.type) {\r\n\r\n    case ADD_NOTIFICATION_MESSAGE:\r\n      return Object.assign({}, state, {\r\n        [payload.id]: {\r\n          counter: 1\r\n        }\r\n      })\r\n    case INCREMENT_NOTIFICATION_MESSAGE:\r\n      if (state[payload.userId]) {\r\n        return Object.assign({}, state, {\r\n          [payload.id]: {\r\n            counter: state[payload.userId].counter + 1\r\n          }\r\n        })\r\n      }\r\n      return Object.assign({}, state, {\r\n        [payload.id]: {\r\n          counter: 1\r\n        }\r\n      })\r\n    case RESET_COUNTER_MESSAGE:\r\n      return Object.assign({}, state, {\r\n        [payload.id]: {\r\n          counter: 0\r\n        }\r\n      })\r\n    case RESET_NOTIFICATION_MESSAGEM:\r\n      return initialState\r\n    default:\r\n      return state\r\n  }\r\n}","export const STATUS_CALL = \"CALL_SET_STATUS\"\r\nexport const STATUS_REST =\"CALL_RESET\"\r\nexport const STATUS_SET_SOCKETTO =\"STATUS_SET_SOCKETTO\"\r\n\r\n\r\nexport default (state = {status: '', to: null, from: null}, action) => {\r\n\r\n  switch (action.type) {\r\n    case STATUS_CALL:\r\n      return { ...state, status: 'call user', ...action.payload }\r\n    case STATUS_REST:\r\n      return { ...state, status: '', to: null, from: null }\r\n    case STATUS_SET_SOCKETTO: \r\n      return {...state, socketTo: action.payload}\r\n    default:\r\n      return state\r\n  }\r\n}","import { SET_MESSAGE_ACTIVE_USER, RESET_MESSAGE_ACTIVE_USER } from './reducers/talk'\r\nimport { ADD_MESSAGE, SET_MESSAGE } from './reducers/messages'\r\nimport { INCREMENT_NOTIFICATION_MESSAGE, RESET_COUNTER_MESSAGE } from './reducers/notifications'\r\nimport { STATUS_CALL, STATUS_REST, STATUS_SET_SOCKETTO } from './reducers/call'\r\nimport { SET_STREAM } from './reducers/stream'\r\nimport { SET_PEER } from './reducers/peer'\r\nimport { SET_ME_SOCKET } from './reducers/me'\r\nexport default {\r\n    SET_MESSAGE_ACTIVE_USER,\r\n    RESET_MESSAGE_ACTIVE_USER,\r\n    ADD_MESSAGE,\r\n    SET_MESSAGE,\r\n    INCREMENT_NOTIFICATION_MESSAGE,\r\n    RESET_COUNTER_MESSAGE,\r\n    STATUS_CALL,\r\n    STATUS_REST,\r\n    STATUS_SET_SOCKETTO,\r\n    SET_STREAM,\r\n    SET_PEER,\r\n    SET_ME_SOCKET\r\n    \r\n}","export const SET_STREAM = \"SET_STREAM\"\r\n\r\n\r\nexport default (state = null, action) => {\r\n\r\n  switch (action.type) {\r\n    case SET_STREAM:\r\n      return action.payload\r\n    default:\r\n      return state\r\n  }\r\n}","export const SET_PEER = \"SET_PEER\"\r\n\r\n\r\nexport default (state = null, action) => {\r\n\r\n  switch (action.type) {\r\n    case SET_PEER:\r\n      return action.payload\r\n    default:\r\n      return state\r\n  }\r\n}","import React, { useEffect, useRef } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport Peer from 'simple-peer'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport {\r\n  Person,\r\n  Search,\r\n} from '@material-ui/icons'\r\nimport { Avatar } from '@material-ui/core'\r\nimport './home.scss'\r\nimport MessageUser from '../../../components/messageUser/message-user'\r\nimport LayoutDefault from '../../../components/layouts/default'\r\nimport AppHeader from '../../../components/widgets/headers/app-header'\r\nimport ListMessage from '../../../components/listMessage/list-message'\r\nimport InputMessage from '../../../components/input-message/input-message'\r\nimport { getUserToken } from '../../../utils/token'\r\nimport { getFriends } from '../../../api/services/friend'\r\nimport listMessagesId from '../../../api/services/messages'\r\n\r\nimport { SET_FRIEND_CHAT } from '../../../stores/reducers/chat'\r\nimport TypeActions from '../../../stores/constants'\r\n\r\n\r\nexport default () => {\r\n  document.title = \"chat - mubenq\"\r\n  const profile = getUserToken()\r\n  let chat = useSelector(state => state.chat.friends)\r\n  let chatTalks = useSelector(state => state.chat.talks)\r\n  let messages = useSelector(state => state.messages)\r\n  let talk = useSelector(state => state.talk)\r\n  let inbox = useSelector(state => state.messages[talk.id]) || []\r\n  const peer = useRef()\r\n  const dispatch = useDispatch()\r\n  const selectMessage = (user) => {\r\n    const talk = chatTalks.find(talk => talk.userFrom === user.id || talk.userTo === user.id)\r\n    dispatch({\r\n      type: TypeActions.SET_MESSAGE_ACTIVE_USER,\r\n      payload: talk\r\n      \r\n    })\r\n    dispatch({\r\n      type: TypeActions.RESET_COUNTER_MESSAGE,\r\n      payload: {\r\n        id: talk.id\r\n      }\r\n    })\r\n  }\r\n  \r\n  useEffect(() => {\r\n    if (chat.length) return\r\n    \r\n    getFriends().then(data => {\r\n      dispatch({\r\n        type: SET_FRIEND_CHAT,\r\n        payload: data\r\n      })\r\n    })\r\n  }, [chat.length, dispatch])\r\n\r\n  useEffect(() => {\r\n    if (talk.id === undefined || messages[talk.id]) return\r\n    listMessagesId(talk.id).then((res) => {\r\n      dispatch({\r\n        type: TypeActions.SET_MESSAGE,\r\n        payload: {\r\n          talkId: talk.id,\r\n          messages: res\r\n        }\r\n      })\r\n    })\r\n  }, [talk, dispatch])\r\n\r\n\r\n  \r\n  useEffect(() => {\r\n    return () => dispatch({type: TypeActions.RESET_MESSAGE_ACTIVE_USER})\r\n  }, [dispatch])\r\n\r\n  const callUser = async (user) => {\r\n    try {\r\n      const stream = await navigator\r\n      .mediaDevices\r\n      .getUserMedia({ video: true})\r\n      \r\n        peer.current = new Peer({\r\n          initiator: true,\r\n          trickle: false,\r\n          stream: stream\r\n        })\r\n        dispatch({\r\n          type: TypeActions.SET_STREAM,\r\n          payload: stream\r\n        })\r\n        dispatch({\r\n          type: TypeActions.SET_PEER,\r\n          payload: peer\r\n        })\r\n      } catch(err) {\r\n        console.log('não foi possivel connectar-se com a sua webcam')\r\n    }\r\n\r\n    dispatch({\r\n      type: TypeActions.STATUS_CALL,\r\n      payload: {\r\n        to: user,\r\n        from: profile.id\r\n      }\r\n    })\r\n  }\r\n  function getFriendIdTalk (id, profile) {\r\n    if (talk.userFrom === profile.id) return talk.userTo\r\n    else if (talk.userTo === profile.id) return talk.userFrom\r\n  }\r\n  return (\r\n    <LayoutDefault>\r\n      <div className=\"home-page\">\r\n        <div className=\"container\">\r\n          <div className=\"row\">\r\n            <aside className=\"column tabnav painel-message\">\r\n              <div className=\"userInfo\">\r\n                <Avatar>\r\n                  <Person fontSize=\"large\" />\r\n                </Avatar>\r\n                <label> {`${profile.firstName} ${profile.lastName}`}</label>\r\n              </div>\r\n              <form className=\"form-search\" action=\"\">\r\n                <label>\r\n                  <input type=\"text\" placeholder=\"search\" disabled />\r\n                  <Search />\r\n                </label>\r\n              </form>\r\n              <ul className=\"message-friends\">\r\n                {chat && chat.map((user) => (\r\n                  <li key={user.id} className={user.id === getFriendIdTalk(talk, profile)? 'active' : ''}>\r\n                    <MessageUser user={user} handlerOpenMessage={() => selectMessage(user)} />\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n              <footer>\r\n                <Link to=\"/findfriend\">encontre amigos</Link>\r\n              </footer>\r\n            </aside>\r\n            <section className=\"column content\">\r\n              {<AppHeader\r\n              user={talk.id !== undefined && chat.filter(friend => friend.id === getFriendIdTalk(talk, profile))[0]}\r\n              handlerCallUser={callUser}\r\n              />}\r\n              {talk.id !== undefined &&\r\n                <ListMessage inbox={inbox} />}\r\n              <footer>\r\n                <InputMessage userId={getFriendIdTalk(talk, profile)} meId={profile.id} />\r\n              </footer>\r\n            </section>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </LayoutDefault>\r\n  )\r\n} ","import api from '../api'\r\nimport getToken from '../../utils/token'\r\n\r\nexport async function getFindFriend() {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.post('/peoples', {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error.response.data\r\n  }\r\n}\r\nexport async function getPeople() {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.get('/peoples', {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error.response.data\r\n  }\r\n}\r\nexport async function addFriend(id) {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.post(`/find-friend/${id}`, {}, {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}\r\n\r\nexport async function getSolicities() {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.get(`/find-friend/solicities`, {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}\r\nexport async function acceptFriend(id) {\r\n  let result\r\n  try {\r\n    const token = getToken()\r\n    result = await api.put(`/find-friend/${id}`, {}, {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    return result.data\r\n  } catch (error) {\r\n    return error\r\n  }\r\n}","import socketIo from 'socket.io-client'\r\n\r\nexport let socket\r\n\r\nexport default function startSocketIO () {\r\n   if (!socket) {\r\n      socket = socketIo(process.env.REACT_APP_URL) // https://mubenq-chat.herokuapp.com\r\n   }\r\n    // console.log(socket)\r\n  return socket\r\n}/*\r\nexport function startChat () {\r\n    socket = socketio(process.env.PUBLIC_URL)\r\n}\r\n*/\r\nexport function getSocket () {\r\n  return socket\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react'\r\nimport {\r\n  AccountCircle\r\n} from '@material-ui/icons'\r\n\r\nimport LayoutDefault from '../../../components/layouts/default'\r\nimport { getPeople, addFriend } from '../../../api/services/findFriend'\r\nimport './find-friend.scss'\r\nexport default () => {\r\n  document.title = \"Encontrar amigos\"\r\n  const [users, setUsers] = useState([])\r\n  useEffect(() => {\r\n    async function loadData () {\r\n      try\r\n      {\r\n        let data = await getPeople()\r\n        setUsers(data)\r\n      }catch (error) {\r\n\r\n      }\r\n    }\r\n    loadData()\r\n  }, [])\r\n  function handlerSolicitarAmizade(id) {\r\n    addFriend(id).then(data => {\r\n      let _users = users.filter(user => user.id !== id)\r\n      setUsers(_users)\r\n    })\r\n  }\r\n  return (\r\n    <LayoutDefault>\r\n      <div className=\"find-friend\">\r\n        <section className=\"result-search-people\">\r\n          <ul className=\"list-people\">\r\n            {\r\n              users.length ? users.map(user => (\r\n                <li key={user.id}>\r\n                  <div className=\"list-people-avatar\">\r\n                    <AccountCircle />\r\n                  </div>\r\n                  <div className=\"list-people-user-info\">\r\n                    <h5>{`${user.firstName} ${user.lastName}`}</h5>\r\n                    <button onClick={() => handlerSolicitarAmizade(user.id)}>solicitar amizade</button>\r\n                  </div>\r\n                </li>\r\n\r\n              )) : <p>lista usuario vazia para si...</p>\r\n            }\r\n          </ul>\r\n        </section>\r\n      </div>\r\n    </LayoutDefault>\r\n  )\r\n}","import React from 'react'\r\nimport {Done} from '@material-ui/icons'\r\nimport './validate-account.scss'\r\nexport default () => {\r\n\r\n  return (\r\n    <div className=\"valide-account-page\">\r\n      <h1>Valide a sua conta</h1>\r\n      <p>abre o seu email e digita o código de validação de 6 digitos...</p>\r\n      <div className=\"group-digit-input-form\">\r\n        <form action=\"\" className=\"validate-account-form\">\r\n          <input type=\"text\" maxLength=\"1\" autoComplete={false}/>\r\n          <input type=\"text\" maxLength=\"1\" validate-account-form/>\r\n          <input type=\"text\" maxLength=\"1\" validate-account-form/>\r\n          <input type=\"text\" maxLength=\"1\" validate-account-form/>\r\n          <input type=\"text\" maxLength=\"1\" validate-account-form/>\r\n          <input type=\"text\" maxLength=\"1\" validate-account-form/>\r\n          <button type=\"submit\">enviar</button>\r\n          <Done fontSize=\"large\" />\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { useEffect } from 'react'\r\nimport { Redirect } from 'react-router-dom'\r\nimport { useDispatch } from 'react-redux'\r\nimport { RESET_NOTIFICATION_MESSAGEM } from '../../../stores/reducers/notifications'\r\nimport { RESET_CHAT } from '../../../stores/reducers/chat'\r\nimport { RESET_MESSAGE_ALERT } from '../../../stores/reducers/messages'\r\nexport default () => {\r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n\r\n    dispatch({\r\n      type: RESET_CHAT\r\n    })\r\n\r\n    dispatch({\r\n      type: RESET_MESSAGE_ALERT\r\n    })\r\n    dispatch({\r\n      type: RESET_NOTIFICATION_MESSAGEM\r\n    })\r\n\r\n  })\r\n  localStorage.clear()\r\n  return (<Redirect to={{ pathname: \"/register\" }} />)\r\n\r\n}","import React, { useState, useEffect } from 'react'\r\nimport {\r\n  AccountCircle\r\n} from '@material-ui/icons'\r\n\r\nimport LayoutDefault from '../../../components/layouts/default'\r\nimport { acceptFriend, getSolicities } from '../../../api/services/findFriend'\r\nimport './accept-request.scss'\r\nexport default () => {\r\n  document.title = \"Encontrar amigos\"\r\n  const [users, setUsers] = useState([])\r\n  useEffect(() => {\r\n    async function loadData() {\r\n      try {\r\n        let data = await getSolicities()\r\n        setUsers(data.friends)\r\n      } catch (error) {\r\n\r\n      }\r\n    }\r\n    loadData()\r\n  }, [])\r\n  function handlerSolicitarAmizade(id) {\r\n    acceptFriend(id).then(data => {\r\n      let _users = users.filter(user => user.id !== id)\r\n      setUsers(_users)\r\n    })\r\n    \r\n  }\r\n  return (\r\n    <LayoutDefault>\r\n      <div className=\"find-friend\">\r\n        <section className=\"result-search-people\">\r\n          <ul className=\"list-people\">\r\n            {\r\n              users.length ? users.map(user => (\r\n                <li key={user.id}>\r\n                  <div className=\"list-people-avatar\">\r\n                    <AccountCircle />\r\n                  </div>\r\n                  <div className=\"list-people-user-info\">\r\n                    <h5>{`${user.firstName} ${user.lastName}`}</h5>\r\n                    <button onClick={() => handlerSolicitarAmizade(user.id)}>aceita solicitação</button>\r\n                  </div>\r\n                </li>\r\n\r\n              )) : <p>não existe pedido para aceitar...</p>\r\n            }\r\n          </ul>\r\n        </section>\r\n      </div>\r\n    </LayoutDefault>\r\n  )\r\n}","import React from 'react'\r\nimport { Switch, Route, Redirect } from 'react-router-dom'\r\nimport HomePage from '../../pages/private/home/home'\r\nimport FindFriendPage from '../../pages/private/FindFriend/findFriend'\r\nimport ValidateAccountPage from '../../pages/private/validateAccount/validate-account'\r\nimport LogoutPage from '../../pages/private/logout/logout'\r\nimport AcceptRequest from '../../pages/private/AcceptRequest/accept-request'\r\n\r\n\r\nconst PrivateRoute = ({ children, ...rest }) => {\r\n  const autheticate = localStorage.getItem('token') || null\r\n  const token = autheticate ? JSON.parse(autheticate) : null\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={({ location }) => {\r\n        return token ? children :\r\n          (\r\n            <Redirect\r\n              to={{\r\n                pathname: '/logout',\r\n                state: { from: location }\r\n              }} />\r\n          )\r\n      }}\r\n    />\r\n  )\r\n}\r\nexport default () => {\r\n  return (\r\n    <Switch>\r\n      <PrivateRoute path=\"/\" exact><HomePage /></PrivateRoute>\r\n      <PrivateRoute path=\"/findfriend\"><FindFriendPage /></PrivateRoute>\r\n      <PrivateRoute path=\"/validateaccount\"><ValidateAccountPage /></PrivateRoute>\r\n      <PrivateRoute path=\"/accept-request\"><AcceptRequest /></PrivateRoute>\r\n      <Route path=\"/logout\" component={LogoutPage} />\r\n    </Switch>\r\n  )\r\n}","import React from 'react'\r\nimport PublicRouter from './public/publicRoutes'\r\nimport PrivateRouter from './private/privateRoutes'\r\nexport default () =>\r\n    (<>\r\n        <PrivateRouter />\r\n        <PublicRouter />\r\n    </>)","import React, { useRef, useEffect } from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport './call.scss'\r\nimport TypeActions from '../../stores/constants'\r\n\r\nexport default function CallModal () {\r\n  const statusCall = useSelector(state => state.call)\r\n  const localVideo = useRef()\r\n  const remoteVideo = useRef()\r\n  const dispatch = useDispatch()\r\n  const peer =  useSelector(state => state.peer)\r\n  const stream = useSelector(state => state.stream)\r\n  const socket = useSelector(state => state.socket)\r\n  const user = getUser()\r\n  \r\n  function getUser () {\r\n    if (statusCall.status === 'call user') {\r\n      return {\r\n        firstName: statusCall.to.firstName,\r\n        lastName: statusCall.to.lastName\r\n      }\r\n    } else if (statusCall.status === 'call accept') {\r\n      return {\r\n        firstName: statusCall.from.profile.firstName,\r\n        lastName: statusCall.from.profile.lastName\r\n      }\r\n    }\r\n    return {\r\n      firstName: '',\r\n      lastName: ''\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    if (localVideo.current) {\r\n     localVideo.current.srcObject = stream\r\n    }\r\n    peer.current.on('stream', stream => {\r\n      remoteVideo.current.srcObject = stream\r\n    })\r\n    peer.current.on('close', () => {\r\n      dispatch({\r\n        type: TypeActions.STATUS_REST\r\n      })\r\n      stream.getTracks().forEach(track => stream.removeTrack(track))\r\n    })\r\n  }, [localVideo, stream, peer])\r\n\r\n  useEffect(() => {\r\n    if (statusCall.status === 'call user') {\r\n      callUser()\r\n    } else if (statusCall.status === 'call accept') {\r\n      acceptCall()\r\n    }\r\n  }, [])\r\n\r\n  useEffect (() => {\r\n    socket.on('call-video-in-action-close', id => {\r\n      dispatch({\r\n        type: TypeActions.STATUS_REST\r\n      })\r\n    })\r\n  }, [])\r\n\r\n  function callUser () {\r\n    peer.current.on('signal', signal => {\r\n      setTimeout(() => {\r\n        socket.emit('call-video-to', {\r\n          offer: signal,\r\n          to: statusCall.to.id,\r\n          from: statusCall.from\r\n        })\r\n\r\n      }, 1000)\r\n    })\r\n    \r\n    socket.on('connection of contact', socket => {\r\n      dispatch({\r\n        type: TypeActions.STATUS_CALL,\r\n        payload: {socketTo: socket},\r\n      })\r\n    })\r\n    socket.on('call-video-in-action', id => {\r\n    })\r\n    socket.on('call-video-accept', data => {\r\n        peer.current.signal(data.answer)\r\n    })\r\n  }\r\n  function acceptCall () {\r\n    \r\n    peer.current.on('signal', signal => {\r\n      setTimeout(() => {\r\n        socket.emit('call-video-accept', {\r\n          answer: signal,\r\n          socket: statusCall.from.socket\r\n        })\r\n      })\r\n    })\r\n    peer.current.signal(statusCall.from.offer)\r\n  }\r\n\r\n  function terminateCall () {\r\n    let user\r\n    switch (statusCall.status) {\r\n      case 'call user':\r\n        user = statusCall.socketTo\r\n        break;\r\n        case 'call accept':\r\n        user = statusCall.from.socket\r\n        break\r\n      default:\r\n        break;\r\n    }\r\n    if (peer.current) {\r\n      peer.current.destroy()\r\n      socket.emit('call-video-in-action-close',{ socket: user })\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"call-modal\">\r\n      <div className=\"wrapper\">\r\n        <p>\r\n          {statusCall.status} {user.firstName} {user.lastName}\r\n        </p>\r\n        <video className=\"call-modal-video remote-video\" width=\"500\" height=\"500\" ref={remoteVideo} autoPlay></video>\r\n        <video className=\"call-modal-video local-video\" autoPlay ref={localVideo} width=\"150\" height=\"150\"></video>\r\n        <div className=\"controls\">\r\n          <button className=\"terminate-call\" onClick={terminateCall} >terminar a chamada</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { useRef } from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport Peer from 'simple-peer'\r\nimport { PhoneCallback } from '@material-ui/icons'\r\nimport TypeActions from '../../stores/constants'\r\nimport './receive-call-video.scss'\r\nexport default () => {\r\n  const state = useSelector(state => state.call)\r\n  const { profile: user } = state.from\r\n  const dispatch = useDispatch()\r\n  const peer = useRef()\r\n \r\n  async function acceptCall () {\r\n    try {\r\n      const stream = await navigator\r\n      .mediaDevices\r\n      .getUserMedia({ video: true})\r\n      peer.current = new Peer({\r\n        initiator: false,\r\n        trickle: false,\r\n        stream: stream\r\n      })\r\n\r\n      dispatch({\r\n        type: TypeActions.SET_STREAM,\r\n        payload: stream\r\n      })\r\n\r\n      dispatch({\r\n        type: TypeActions.SET_PEER,\r\n        payload: peer\r\n      })\r\n\r\n    } catch(err) { }\r\n\r\n    dispatch({\r\n      type: TypeActions.STATUS_CALL,\r\n      payload: {\r\n        status: 'call accept'\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"receive-call-video\">\r\n      <div className=\"wrapper\">\r\n        <h3>Call Receive...</h3>\r\n        <h5>{`${user.firstName} ${user.lastName}`}</h5>\r\n        <button className=\"btn-link\" onClick={() => acceptCall(user)}>\r\n          <PhoneCallback fontSize=\"large\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, {useEffect, useRef} from 'react';\r\nimport { BrowserRouter } from 'react-router-dom'\r\nimport Routes from './routes/routes'\r\nimport startSocket from './api/socket'\r\nimport {CONNECTION } from './stores/reducers/reducers'\r\nimport {useDispatch, useSelector} from 'react-redux'\r\nimport getToken from './utils/token';\r\n\r\nimport TypeActions from './stores/constants'\r\nimport CallModal from './components/callModal/call'\r\nimport ReceiveCallVideo from './components/ReceiveCallVideo/receive-call-video'\r\n\r\nfunction App() {\r\n  const dispatch = useDispatch()\r\n  const call = useSelector(state => state.call)\r\n  \r\n  const token = getToken()\r\n  const socket = useRef()\r\n\r\n  useEffect(() => {\r\n    socket.current = startSocket()\r\n    dispatch({\r\n      type: CONNECTION,\r\n      payload: socket.current\r\n    })\r\n    if (!token) {\r\n      window.localStorage.clear()\r\n    }\r\n  \r\n    socket.current.on('connect', () => {\r\n      socket.current.emit('set-token', token)\r\n    })\r\n  \r\n    socket.current.on('call-video-in-action-close', () => {\r\n      dispatch({\r\n        type: TypeActions.STATUS_REST\r\n      })\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    socket.current.off('call-video-from')\r\n    socket.current.on('call-video-from', data => {\r\n      if (!call.status) {\r\n        dispatch({\r\n          type: TypeActions.STATUS_CALL,\r\n          payload: {status: 'receive call', from: data},\r\n        })\r\n      }\r\n    })\r\n  }, [call])\r\n\r\n  useEffect(() => {\r\n    if (!socket.current) return\r\n    socket.current.off('new-message')\r\n    socket.current.on('new-message', (data) => {\r\n      dispatch({\r\n        type: TypeActions.ADD_MESSAGE,\r\n        payload: {\r\n          userId: data.talkId,\r\n          message: data\r\n        }\r\n      })\r\n      dispatch({\r\n        type: TypeActions.INCREMENT_NOTIFICATION_MESSAGE,\r\n        payload: {\r\n          id: data.talkId,\r\n          message: data\r\n        }\r\n      })\r\n    })\r\n  }, [socket])\r\n\r\n  useEffect(() => {\r\n    \r\n    socket.current.off('save-message')\r\n\r\n    socket.current.on('save-message', data => {\r\n      dispatch({\r\n        type: TypeActions.ADD_MESSAGE,\r\n        payload: {\r\n          userId: data.talkId,\r\n          message: data\r\n        }\r\n      })\r\n    })\r\n  }, [socket])\r\n  \r\n\r\n  let Modal\r\n  switch (call.status) {\r\n    case 'call user':\r\n    case 'call accept':\r\n      Modal = (<CallModal />)\r\n      break;\r\n    case 'receive call':\r\n      Modal = (<ReceiveCallVideo />)\r\n      break\r\n    default:\r\n      Modal = (<></>)\r\n      break;\r\n  }\r\n  return (\r\n    <div className=\"App\">\r\n      <BrowserRouter>\r\n        {Modal}\r\n        <Routes />\r\n      </BrowserRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","export const CONNECTION = \"CONNECTION\"\r\nexport const DISCONNECT = \"DISCONNECT\"\r\nexport const RESET_CONNECTION = \"RESET CONNECTION\"\r\nexport function socket(state = null, action) {\r\n\r\n  switch (action.type) {\r\n    case CONNECTION:\r\n      return action.payload\r\n    case DISCONNECT:\r\n      return null\r\n    case RESET_CONNECTION:\r\n      return null\r\n    default:\r\n      return state\r\n  }\r\n}","import { createStore, combineReducers } from 'redux'\r\n\r\nimport {socket} from './reducers/reducers'\r\nimport chat from './reducers/chat'\r\nimport messages from './reducers/messages'\r\nimport alerts from './reducers/notifications'\r\nimport talk from './reducers/talk'\r\nimport call from './reducers/call'\r\nimport stream from './reducers/stream'\r\nimport peer from './reducers/peer'\r\nimport me from './reducers/me'\r\nconst reducers = combineReducers({\r\n    socket,\r\n    chat,\r\n    messages,\r\n    alerts,\r\n    talk,\r\n    call,\r\n    stream,\r\n    peer,\r\n    me\r\n})\r\n\r\nconst store = createStore(reducers)\r\nwindow.store = store\r\nexport default store\r\n","export const SET_ME_SOCKET = \"SET_PEER\"\r\n\r\n\r\nexport default (state = {socket: null}, action) => {\r\n\r\n  switch (action.type) {\r\n    case SET_ME_SOCKET:\r\n      return { ...state, socket: action.payload }\r\n    default:\r\n      return state\r\n  }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport {Provider} from 'react-redux'\r\nimport store  from './stores/store'\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n","module.exports = __webpack_public_path__ + \"static/media/logo.9235a458.png\";"],"sourceRoot":""}